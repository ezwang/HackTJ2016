{% extends "layout.html" %}
{% block head %}
    {{ super() }}
{% endblock %}
{% block content %}
<style>
#word-list:empty:before
{
    border-top:1px solid #ccc;
    display:block;
    content: 'No Words';
    color:#BDBDBD;
    padding:15px;
    font-size:2em;
}
#word-list
{
    border-bottom:1px solid #ccc;
}
.card
{
    padding:15px;
    margin-bottom:30px;
}
.word-item
{
    border-top:1px solid #ccc;
    padding:15px;
    font-size:2em;
}
.word-item:after
{
    display:block;
    clear:both;
}
.word-item-delete
{
    float:right;
    cursor:pointer;
    font-weight:bold;
    color:#aaa;
}
.word-item-delete:hover
{
    color:#F44336;
}
#practice-word
{
    font-size:4em;
    text-align:center;
}
#practice-word:empty:before
{
    content:'(None)';
    color:#aaa;
}
</style>
<script>
$(document).ready(function() {
    window.AudioContext = window.AudioContext || window.webkitAudioContext;
    navigator.getUserMedia = ( navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia);
    window.URL = window.URL || window.webkitURL;

    var audio_context = new AudioContext;

    $("#add-word").click(function(e) {
        e.preventDefault();
        if (!$("#new-word").val()) {
            return;
        }
        $("#btn-toggle").prop("disabled", false);
        $("#word-list").append($("<div class='word-item'><span class='word-item-text'>" + $("<div />").text($("#new-word").val()).html() + "</span><span class='word-item-delete'>&times;</span></div>"));
        $("#new-word").val("");
    });
    $("#new-word").keyup(function(e) {
        if (e.keyCode == 13) {
            $("#add-word").click();
        }
    });
    $("#word-list").on("click", ".word-item-delete", function(e) {
        e.preventDefault();
        $(this).parent().remove();
        if ($("#word-list .word-item").length == 0) {
            $("#btn-toggle").prop("disabled", true);
            playing = false;
        }
    });
    var playing = false;
    $("#btn-toggle").click(function(e) {
        e.preventDefault();
        if ($("#word-list .word-item").length == 0) {
            return;
        }
        playing = !playing;
        $("#btn-toggle").text(!playing ? 'Start Practice' : 'Stop Practice');
        load_practice_word($("#word-list .word-item").eq(Math.floor(Math.random() * $("#word-list .word-item").length)).find(".word-item-text").text());
    });
});
function load_practice_word(word) {
    $("#practice-word").text(word);
}
</script>
<div class="card">
    <h3>Word Practice</h3>
    <div id="practice-word"></div>
    <button id="btn-toggle" class="btn btn-raised btn-primary" disabled>Start Practice</button>
</div>
<div class="card">
    <h3>Word List</h3>
    <div id="word-list"></div>
    <div class="form-group">
        <label for="new-word" class="control-label">New Word</label>
        <input type="text" id="new-word" name="new-word" class="form-control" placeholder="New Word" />
    </div>
    <button id="add-word" class="btn btn-raised btn-success">Add Word</button>
</div>
{% endblock %}
